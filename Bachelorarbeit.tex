\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[ngerman,german]{babel}
\usepackage[T1]{fontenc}
\usepackage{courier}
\usepackage{float}
\usepackage{amsmath,amsthm}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{csquotes}
\usepackage[font=small,labelfont=bf]{caption}

%\usepackage[pages=some]{background} % Draft Wasserzeichen mit Option pages=all sonst pages=some



\title{Bachelorarbeit}
\author{

	Andreas Windorfer\\
}
\date{\today}


\begin {document}


\maketitle
\newpage
Zusammenfassung
\newpage
\tableofcontents


\newpage

\section {Einleitung}
\section{Fazit}
\section{Dynamische binäre Suchbäume}
innerer Knoten\\
Teilbaum\\
Höhe Nur eine Wurzel vorhanden, dann Höhe 0\\
innerer Knoten, auch Wurzel\\
Rotationen\\
Einfügen\\
Suchen\\
Löschen\\
Bruder\\
Höhe\\
Pfad\\
\section{Balancierte Suchbäume}
\subsection{Rot-Schwarz-Baum}
Der Rot-Schwarz-Baum gehört zur Gruppe der balancierten binären Suchbäume. Zusätzlich zu den Zeigern \textit{links}, \textit{rechts} und \textit{vorgaenger} benötigt jeder Knoten ein zusätzliches Bit Speicherplatz, um die Farbinformation zu speichern. Der Name der Datenstruktur kommt daher, dass die beiden durch das zusätzliche Bit unterschiedenen Zustände als \textit{Rot} und \textit{Schwarz} bezeichnet werden. Die Farbe ist also eine Eigenschaft der Knoten und im folgenden wird einfach von roten bzw. schwarzen Knoten gesprochen. Zeiger auf Nachfolger oder Vorgänger die aktuell im Baum nicht vorhanden sind zeigen auf einen schwarzen Sonderknoten. Dieser Sonderknoten enthält in dieser Arbeit den Schlüsselwert \textit{null}.  


\noindent Folgende zusätzliche Eigenschaften müssen bei einem Rot-Schwarz-Baum erfüllt sein. 

\begin{enumerate}
	\item Jeder Knoten ist entweder rot oder schwarz.
	\item Die Wurzel ist schwarz.
	\item Jedes Blatt ist schwarz.
	\item Beide Nachfolger eines roten Knotens sind schwarz.
	\item Für jeden Knoten enthalten alle Pfade, die an diesem Knoten starten und in einem Blatt enden, die gleiche Anzahl an schwarzen Knoten. 
\end{enumerate}  

\noindent  Der Zweck dieser Einschränkungen ist es die Höhe des Rot-Schwarz-Baumes zu begrenzen, um die üblichen Operationen effizient ausführen zu können. Als \textbf{Schwarz-Höhe} $\mathit{bh(x)}$ eines Knoten $x$ wird die Anzahl der schwarzen Knoten in einem Pfad, der an dem Knoten startet und in einem Blatt endet, bezeichnet. Die eigene Farbe des betrachteten Knotens bleibt dabei außen vor. Dadurch hat ein Knoten die gleiche Schwarz-Höhe wie ein roter Nachfolger und eine um eins erhöhte Schwarz-Höhe gegenüber einem schwarzen Nachfolger. Aufgrund der Eigenschaft fünf ist die Schwarz-Höhe eines Knotens wohldefiniert. Die Höhe $h$ ist beim Rot-Schwarz-Baum wie bei anderen binären Suchbäumen definiert und berücksichtigt auch die roten Knoten. Die Schwarz-Höhe der Wurzel des Baumes in Abbildung \ref{fig:IOBaum} ist also zwei. Im Folgenden wird manchmal nur die Nummer einer Eigenschaft verwendet. Bezieht sich der Text also beispielsweise auf Eigenschaft zwei, ist damit die Eigenschaft bzgl. der schwarzen Wurzel gemeint.
\\
\begin{figure}[h]
	\centering
	\includegraphics[width= 1\textwidth]{"Medien/RotSchwarzBaum/IOBaum"}
	\caption{Rot-Schwarz-Baum ohne Verletzung von Eigenschaften. }
	\label{fig:IOBaum}
\end{figure}
\begin{figure}[h]
	\centering
	\includegraphics[width= 1\textwidth]{"Medien/RotSchwarzBaum/NIOBaumZweiRote"}
	\caption{Rot-Schwarz-Baum bei dem Eigenschaft vier und fünf verletzt sind. }
	\label{fig:NIOBaumZweiRote}
\end{figure}
\begin{figure}[h]
	\centering
	\includegraphics[width= 1\textwidth]{"Medien/RotSchwarzBaum/NIOBaumPfadlänge"}
	\caption{Rot-Schwarz-Baum bei dem Eigenschaft fünf verletzt ist.  }
	\label{fig:NIOBaumPfadlänge}
\end{figure}


\subsubsection{Einfügen in den Rot-Schwarz-Baum}
Ein neuer Schlüssel wird zunächst wie in Ref: (normales Einfügen) eingefügt. Zusätzlich werden dann noch die Zeiger \textit{links} und  \textit{rechts} auf den schwarzen Sonderknoten gesetzt. Die Farbe neu eingefügter Knoten ist rot. Durch den neu eingefügten Knoten können Korrekturen notwendig werden, um die Rot-Schwarz-Baum Eigenschaften zu erhalten. Zunächst betrachten wir der Reihe nach welche der fünf Eigenschaften betroffen sein können. Es wird davon ausgegangen, dass in einen Rot-Schwarz-Baum ohne Verletzung von Eigenschaften eingefügt wurde. \\

\begin{enumerate}
	\item Es ist immer noch jeder Knoten entweder rot oder schwarz.
	\item Wurde in den leeren Baum eingefügt, so ist der neu eingefügte rote Knoten die Wurzel, was eine Verletzung darstellt. Waren bereits Knoten im Baum vorhanden bleibt die Wurzel unverändert.
	\item Aufgrund des Sonderknotens sind die Blätter immer noch schwarz.
	\item Der Baum wird nur direkt an der Einfügestelle verändert. Der neue Knoten hat schwarze Nachfolger, er könnte jedoch einen roten Vorgänger haben, so dass diese Eigenschaft verletzt wäre.
	\item Da der neue Knoten rot ist, ändern sich keine Schwarz-Höhen von bereits enthaltenen Knoten. Die Schwarz-Höhe des neuen Knoten ist immer $1$, denn beide Nachfolger verweisen auf den schwarzen Sonderknoten. Eigenschaft fünf bleibt also erhalten. 
\end{enumerate}  

\noindent Es können also die Eigenschaften zwei und vier betroffen sein. Jedoch nur eine von ihnen, denn Eigenschaft zwei wird genau dann verletzt wenn der neue Knoten der Einzige im Baum ist. Dann kann er aber keinen roten Vorgänger haben.

 \noindent Zur Korrektur wird eine zusätzliche Routine eingesetzt. Diese Routine arbeitet sich von der Einfügestelle solange nach oben in einer Schleife durch, bis alle Eigenschaften wieder erfüllt sind. Die Schleifenbedingung ist, dass eine Verletzung vorliegt. Dazu muss geprüft werden ob der betrachtete Knoten die rote Wurzel des Gesamtbaumes ist, oder ob er und sein Vorgänger beide rot sind. Beim ersten Durchlauf wird der neu eingefügte Knoten übergeben. Innerhalb der Schleife werden sechs Fälle unterschieden. Im folgenden wird auf vier Fälle detailliert eingegangen. Die restlichen zwei verhalten sich symmetrisch zu einem solchen. Jeder der Fälle verantwortet, dass zum Start der nächsten Iteration wieder nur maximal eine der beiden Eigenschaften zwei oder vier verletzt sein kann und Eigenschaft vier lediglich an einer Stelle verletzt wird.  Eigenschaft eins bleibt in der Beschreibung außen vor, da es während der gesamten Laufzeit der Routine nur Knoten gibt, die entweder rot oder schwarz sind. \\
 
\noindent\textbf{Fall 1: Die Wurzel ist rot: }
Dieser Fall wird behandelt in dem man die Wurzel schwarz färbt. Man muss noch zeigen, dass es durch das Umfärben zu keiner anderen Verletzung gekommen ist.\\

Betrachtung der Eigenschaften:
\begin{enumerate}
	\item -
	\item Die Wurzel wurde schwarz gefärbt.
	\item Die Blätter sind unverändert.
	\item Es wurden weder rote Knoten hinzugefügt, noch wurden Zeiger umgesetzt. 
	\item Da Umfärben der Wurzel kann hierauf keinen Einfluss haben, da sie in der Berechnung der Schwarz-Höhe jedes  Knotens außen vor ist.
\end{enumerate}  

\noindent Es wird also keine Eigenschaft mehr verletzt und die Schleife wird keine weitere Iteration durchführen.\\
 Die Fälle 2 - 6 behandeln nun die Situation zweier aufeinanderfolgender roter Knoten. Der untere rote Knoten wird als $x$ bezeichnet, der obere als $y$. Da Eigenschaft fünf nach jeder Iteration erfüllt ist muss $y$ einen Bruder haben. Denn da $y$ rot ist und Fall 1 nicht ausgewählt wurde, kann es nicht die Wurzel sein. Also muss auch $y$ einen Vorgänger $z$ haben. Von $z$ aus starten über $y$ mindestens zwei Pfade zu schwarzen Blättern. Hätte $z$ nicht auch einen rechten Nachfolger, wäre bereits vor der Iteration Eigenschaft fünf verletzt gewesen. Wenn sich auf die Situation nach der Fallbehandlung bezogen wird, wird den Variablen ein Hochstrich hinzugefügt. Wurde beispielsweise Knoten $y$ von rot nach schwarz gefärbt, so ist $y$ rot und $y'$ schwarz. \\
 
\noindent\textbf{Fall 2: Der Bruder von $y$ ist rot: }
\noindent Diesen Fall veranschaulicht Abbildung \ref{fig:EinfügenFixUpFall2}. Da $y$ rot ist, muss $z$ nach Eigenschaft schwarz sein, ansonsten wäre Eigenschaft vier mehrfach verletzt gewesen. Nun wird $z$ rot gefärbt und beide Nachfolger von $z$, also $y$ und dessen Bruder, schwarz. Somit hat $x$ nun einen schwarzen Vorgänger und die Verletzung der Eigenschaft vier wurde an dieser Stelle behoben. Wie sieht es aber mit den Verletzungen insgesamt aus ? \\

Betrachtung der Eigenschaften:

\begin{enumerate}
	\item -
	\item Wenn $z$ die Wurzel des Baumes ist, wurde sie rot gefärbt und eine Verletzung liegt vor.
	\item Der rot umgefärbte Knoten $z'$ hat zwei Nachfolger, somit wurde kein Blatt rot gefärbt.
	\item  Wenn der rot gefärbte Knoten $z$ nicht die Wurzel ist, könnte er einen roten Vorgänger haben und Eigenschaft vier ist weiterhin Verletzt, das Problem liegt nun aber zwei Baumebenen höher.
	\item  Die Schwarz-Höhen der Pfade mit $z'$ als inneren Knoten ändern sich nicht, da sie auch genau eines der schwarz umgefärbten Nachfolger von $z'$ enthalten müssen. Die Schwarz-Höhen der Pfade mit $z'$ als Startknoten werden um eins verringert. Dies gilt jedoch für jeden von ihnen, so dass Eigenschaft fünf weiterhin nicht verletzt wird.
\end{enumerate} 
Es kann also wieder nur entweder Eigenschaft zwei oder vier verletzt sein. Wenn die Problemstelle noch nicht an der Wurzel ist, so ist sie zumindest um zwei Ebenen nach oben gewandert. 
\begin{figure}[h]
	\centering
	\includegraphics[width= 1\textwidth]{"Medien/RotSchwarzBaum/EinfügenFixUpFall2"}
	\caption{Korrektur nach dem Einfügen. Dargestellt ist Fall 2  }
	\label{fig:EinfügenFixUpFall2}
\end{figure}

\noindent\textbf{Fall 3: $y$ ist ein linker Nachfolger und sein Bruder ist schwarz. $x$ ist linker Nachfolger: }\\
\noindent Abbildung \ref{fig:EinfügenFixUpFall3} zeigt eine entsprechende Situation. Da in dieser Situation, die Wurzel schwarz sein muss, gibt es den Vorgänger $z$ von $y$. Da es nur eine Stelle im Baum geben kann an der Eigenschaft vier verletzt wird, muss $z$ schwarz sein. Es wird nun eine Rechtsrotation auf $z$ ausgeführt. Anschließend wird $z$ rot gefärbt und $y$ schwarz. \\

Betrachtung der Eigenschaften:\\
\noindent Dazu werden vier weitere Variablen auf Knoten verwendet. Es zeigt $\enquote{xl}$ den linken Nachfolger von $x$,  $\enquote{xr}$ entsprechend den rechten Nachfolger. $\enquote{yr}$ und $zr$ bezeichnen die rechten Nachfolger von $y$ bzw. $z$. Nachfolgend wird verwendet, dass die Teilbäume $xl$, $xr$, $yr$ und $zr$ durch die Ausführung unverändert bleiben.
\begin{enumerate}
	\item -
	\item Wenn $z$ zu Beginn nicht die Wurzel des Gesamtbaumes war, blieb diese unbearbeitet. Ansonsten wurde durch die Rotation $y'$ zur neuen Wurzel und $y'$ wurde schwarz gefärbt. 
	\item  Alle vier Plätze in der zweiten Ebene unter $z$ werden von den unveränderten Teilbäumen $xl$, $xr$, $yr$ oder $zr$ besetzt. An den Blättern verändert sich also durch die Ausführung nichts.
	\item  Knoten $x'$ ist jetzt direkter linker Nachfolger der neuen schwarzen Wurzel $y'$ des Teilbaumes. An den nachfolgenden Teilbäumen von $x'$ hat sich nichts geändert. Die linke Seite des neu entstandenen Baumes enthält also keine aufeinanderfolgenden roten Knoten. Der rechte Nachfolger von $y'$ ist der rote $z'$. Rechts an $z'$ hängt nun ein unveränderter Teilbaum, dessen Wurzel zuvor Bruder von $y$ war. Dieser ist nach Fallunterscheidung ein schwarzer Knoten. Links hängt ebenfalls ein unveränderter Teilbaum, dessen Wurzel zuvor rechter Nachfolger von $y$ war. Der rechte Nachfolger von $y$ muss schwarz sein, ansonsten wäre Eigenschaft vier an zwei Stellen verletzt gewesen. Im Teilbaum mit Wurzel $y$ gibt es also keine aufeinanderfolgenden roten Knoten. Da $y$ schwarz gefärbt wurde kann auch nach oben keine neue Verletzung entstanden sein.  
	\item  Es gilt  $\mathit{bh(xl)} = \mathit{bh(xr)} = \mathit{bh(yr)} =  \mathit{bh(zr)} = \mathit{bh(z)} - 1$. Wie oben bereits erwähnt wird die zweite Ebene unter der Wurzel von den Knoten $\mathit{xl'}$, $\mathit{xr'}$, $\mathit{yr'}$ und $\mathit{zr'}$ gebildet. Es müssen also lediglich die Knoten $x'$, $y'$ und $z'$ betrachtet werden. An $x'$ und an $z'$ folgen schwarze Knoten mit der Schwarz-Höhe $\mathit{bh(z)} - 1$. Die Schwarz-Höhen von $x'$ und $z'$ ist also wohldefiniert und es gilt $mathit{bh(x')} = \mathit{bh(z')} = \mathit{bh(z)}$. $y'$ Nachfolger sind die roten Knoten $x'$ und $z'$. Da die beide Nachfolger rot sind gilt $\mathit{bh(y')} = mathit{bh(x')} = \mathit{bh(z')}$. Somit sind alle Schwarz-Höhen im betrachteten Teilbaum in Ordnung. Die neue Wurzel der Teilbaumes $y'$ hat die gleiche Schwarz-Höhe und die gleiche Farbe wie die vorherige Wurzel $z$. Damit kann es auch im Gesamtbaum zu keiner Verletzung der Eigenschaft gekommen sein.
\end{enumerate} 

\noindent Es ist keine der Eigenschaften verletzt, daher wird es zu keiner Iteration mehr kommen.


\noindent\textbf{Fall 4: $y$ ist ein linker Nachfolger und sein Bruder ist schwarz. $x$ ist rechter Nachfolger: }\\      
Dieser in Abbildung \ref{fig:EinfügenFixUpFall4} gezeigte Fall wird so umgeformt, dass eine Situation entsteht bei der Fall drei angewendet werden kann. Dazu wird eine Linksrotation an Knoten $y$ durchgeführt.\\

\noindent Betrachtung der Eigenschaften:\\
Veränderungen gab es durch die Rotation lediglich im linken Teilbaum von $z$. Es seien $\mathit{xl}$ und $\mathit{xr}$ die linken schwarzen Nachfolgeknoten von $x$. $\mathit{yl}$ ist der linke Nachfolger von $y$. $\enquote{xl}$, $\enquote{xr}$ und $\enquote{yr}$ müssen schwarz sein, ansonsten wäre Eigenschaft vier mehrfach verletzt gewesen.
\begin{enumerate}
	\item -
	\item Die Wurzel ist an der Ausführung nur beteiligt wenn $z'$ auf sie zeigt. $z'$ ist schwarz.
	\item  Die Teilbäume  $\mathit{xl}$, $\mathit{xr}$ und $\mathit{yr}$ enthalten alle Blätter innerhalb des linken Teilbaumes von $z$. Außerdem bleiben die Teilbäume  $\mathit{xl}$, $\mathit{xr}$ und $\mathit{yr}$ durch die Rotation unverändert und sie enthalten auch alle Blätter des linken Teilbaumes von $z'$.
	\item Da $x$ und $y$ rot sind müssen $z$, $\mathit{xl}$ und $\mathit{xr}$ schwarz sein. Durch die Rotation ist $y'$ linker Nachfolger von $x'$. $x'$ ist Nachfolger vom schwarzen $z'$. Alle verbleibenden Nachfolger von $x'$ und $y'$ werden durch die unveränderten Teilbäume $\mathit{xl'}$, $\mathit{xr'}$ und $\mathit{yr'}$ gebildet. Deren Wurzeln müssen schwarz sein, ansonsten hätte es in ursprünglichen Baum an mehr als einer Stelle eine Verletzung von Eigenschaft vier gegeben. Durch die Rotation verbleibt es also bei einer Verletzung der Eigenschaft vier in der gleiche Baumebene. Die beiden beteiligten roten Knoten sind nun aber linke Nachfolger.   
	\item Sei $b$ die Schwarz-Höhe von $yl$. Es gilt $b = \mathit{bh(yl)} = \mathit{bh(xl)} = \mathit{bh(xr)}$. Nun wird der linke Teilbaum von $z'$ von unten nach oben betrachtet. Die Nachfolger von $y'$ sind $yl$ und $xl$. Es muss gelten $\enquote{bh(y')} = = b + 1$. $x'$ hat den roten $y'$ als Nachfolger und den schwarzen $xr$, es gilt also $\enquote{bh(x')} = b + 1$. Die Schwarz-Höhe von $y$ ist $b +1$. Damit gilt $\enquote{bh(y)} = \enquote{bh(x')}$ und $y$ und $x'$ haben die gleiche Farbe, damit gilt $\enquote{bh(z)} = \enquote{bh(z')}$.
\end{enumerate}  

\noindent Es sind also weiterhin zwei rote aufeinanderfolgende rote Knoten in den gleichen Baumebenen vorhanden. Diese sind nun aber beides linke Knoten. Der Bruder des oberen roten Knotens ist der selbe schwarze Knoten wie vor der Ausführung von Fall 4. Damit kann direkt mit dem bearbeiten von Fall 3 begonnen werden.\\

\noindent\textbf{Fall 5: $y$ ist ein rechter Nachfolger und sein Bruder ist schwarz. $x$ ist rechter Nachfolger: }\\ 
	Symmetrisch zu Fall 3
	noch ausführen
\noindent\textbf{Fall 6: $y$ ist ein rechter Nachfolger und sein Bruder ist schwarz. $x$ ist linker Nachfolger: }\\ 
Symmetrisch zu Fall 4
noch ausführen


\begin{figure}[h]
	\centering
	\includegraphics[width= 1\textwidth]{"Medien/RotSchwarzBaum/EinfügenFixUpFall3"}
	\caption{Korrektur nach dem Einfügen. Dargestellt ist Fall 3  }
	\label{fig:EinfügenFixUpFall3}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width= 1\textwidth]{"Medien/RotSchwarzBaum/EinfügenFixUpFall4"}
	\caption{Korrektur nach dem Einfügen. Dargestellt ist Fall 4  }
	\label{fig:EinfügenFixUpFall4}
\end{figure}


   
\subsubsection{Löschen aus dem Rot-Schwarz-Baum}

\subsubsection{Suchen im Rot-Schwarz-Baum}


\noindent\textbf{Lemma: Maximale Höhe des Rot-Schwarz-Baum}:\\
Für einen Rot-Schwarz-Baum mit Höhe $h$ und $n$ inneren Knoten gilt $h \leq  2 lg(n + 1)$. \\
\noindent\textbf{Beweis:}\\
Zunächst wird gezeigt, dass ein Teilbaum $t_1$ mit Wurzel $x_1$ und Schwarzhöhe $\mathit{bh(x_1)}$ zumindest über $2^{bh(x_1)} - 1$ innere Knoten verfügt, also $n \geq 2^{bh(x_1)} - 1 $. Dies wird durch Induktion über die Höhe $\mathit{h_{x_1}}$ gezeigt. Für $\mathit{h_{x_1}} = 0$ besteht $t_1$ nur aus einem Blatt und enthält keine inneren Knoten. Natürlich gilt in diesem Fall auch $\mathit{bh(t_1) = 0}$.  \\
Induktionsanfang mit $\mathit{h_{x_1} = 0}$ :\\
$2^{0} - 1 = 0$\\
Induktionsschritt:\\
Nun wird ein Teilbaum $T_2$ mit Wurzel $x_2$ mit Höhe $h + 1$ betrachtet. Jedes seiner beiden Nachfolger hat entweder Schwarzhöhe  $\mathit{bh(x_2)}$, wenn es rot ist, oder $\mathit{bh(x_2) - 1}$, wenn es schwarz ist. Die Höhe beider Nachfolger ist niedriger als die eigene Höhe von $x_2$. Somit kann bei beiden Nachfolgern jeweils die Induktionsnahme für die Mindestanzahl der inneren Knoten eingesetzt werden.   \\
$2^{bh(x_1)-1} - 1 + 2^{bh(x_1)-1} - 1  = 2^{bh(x_1)} - 2 $ \\
Addiert man einen inneren Knoten aufgrund der Wurzel $x_2$ hinzu, erhält man die Behauptung.\\
$2^{bh(x_1)} - 2 + 1 = 2^{bh(x_1)} - 1 $.\\
Es gilt also $n \geq 2^{\mathit{bh(x)}} - 1$.

\noindent Auf einem Pfad in einem Rot-Schwarz-Baum $t_3$ von der Wurzel bis zu einem Blatt sind der erste und der letzte Knoten, sowie mindestens jeder zweite der weiteren Knoten schwarz. Es gilt also $\mathit{bh(t_3)} \geq \frac{h(t_3)}{2}$. 
Damit kann man in der Ungleichung $\mathit{bh(t_3)}$ durch $\mathit{h(t_3)}$ ersetzen, woraus dann das Lemma folgt.\\
$n \geq 2^{\frac{\mathit{h(t_3)}}{2}} - 1 \Rightarrow n + 1 \geq 2^{\frac{\mathit{h(t_3)}}{2}} \Rightarrow
\lg(n + 1) \geq \frac{h(t_3)}{2} \Rightarrow 2 lg(n + 1) \geq h(t_3) $ 



\newpage
\bibliography{literaturverzeichnis}
\bibliographystyle{unsrt}

\end {document}